{namespace nz=CuyZ\Notiz\ViewHelpers}
{namespace b=TYPO3\CMS\Backend\ViewHelpers}

<f:layout name="Backend/Default" />

<f:section name="HeaderButtons">
    <f:render partial="Backend/Index/HeaderButtons" section="Buttons" arguments="{_all}" />
</f:section>

<f:section name="Content">
    <f:render partial="Backend/Index/CreateNotificationModal"
              section="Content"
              arguments="{definition: definition}" />

    <div class="container">
        <div class="page-header">
            <h1>Available events</h1>
        </div>

        <f:be.infobox>
            <nz:format.nl2brTrim>
                <nz:t key="Backend/Module/Index/ListEvents:introduction" />
            </nz:format.nl2brTrim>
        </f:be.infobox>

        <div class="row">
            <div class="col-md-12">
                <table class="table table-striped table-hover list-events">
                    <f:for each="{definition.eventGroups}" as="eventGroup">
                        <thead>
                            <tr>
                                <th colspan="3">{eventGroup.label}</th>
                            </tr>
                        </thead>

                        <f:for each="{eventGroup.events}" as="event">
                            <tr>
                                <td>
                                    <f:link.action action="showEvent"
                                                   arguments="{eventIdentifier: event.fullIdentifier}"
                                                   title="{nz:t(key: 'Backend/Module/Index/ListEvents:show_event_details')}">

                                        {event.label}
                                        <f:if condition="{event.notificationNumber}">
                                            ({event.notificationNumber})
                                        </f:if>
                                    </f:link.action>
                                </td>

                                <td>
                                    <div class="text-left event-description">
                                        {event.description}
                                    </div>
                                </td>

                                <td align="right">
                                    <div class="btn-group" role="group">
                                        <a href="#"
                                           title="{nz:t(key: 'Backend/Module/Index/Global:create_notification')}"
                                           class="link-create-notification btn btn-default"
                                           data-toggle="modal"
                                           data-target="#create-notification"
                                           data-event-identifier="{event.fullIdentifier}">
                                            <nz:core.icon identifier="actions-add" />
                                        </a>

                                        <f:link.action action="showEvent"
                                                       arguments="{eventIdentifier: event.fullIdentifier}"
                                                       class="btn btn-default"
                                                       title="{nz:t(key: 'Backend/Module/Index/ListEvents:show_event_details')}">
                                            <nz:core.icon identifier="actions-view" />
                                        </f:link.action>
                                    </div>
                                </td>
                            </tr>
                        </f:for>
                    </f:for>
                </table>
            </div>
        </div>
    </div>
</f:section>
