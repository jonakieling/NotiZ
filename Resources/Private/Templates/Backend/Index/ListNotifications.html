{namespace nz=CuyZ\Notiz\ViewHelpers}
{namespace b=TYPO3\CMS\Backend\ViewHelpers}

<f:layout name="Backend/Default" />

<f:section name="HeaderButtons">
    <f:render partial="Backend/Index/HeaderButtons" section="Buttons" arguments="{_all}" />
</f:section>

<f:section name="Content">
    <div class="container">
        <div class="page-header">
            <h1>
                <nz:core.icon identifier="{notificationDefinition.iconIdentifier}" size="default" />
                {notificationDefinition.label}
            </h1>
        </div>

        <p>
            <f:link.action controller="Backend\Index"
                           action="listNotificationTypes"
                           class="btn btn-default">
                <nz:core.icon identifier="actions-view-go-back" />
                <nz:t key="Backend/Module/Index/Global:show_notification_types" />
            </f:link.action>

            <nz:backend.notification.createLink notificationDefinition="{notificationDefinition}"
                                                class="btn btn-default"
                                                title="{nz:t(key: 'Backend/Module/Index/Global:create_notification')}">
                <nz:core.icon identifier="actions-add" />
                <nz:t key="Backend/Module/Index/Global:create_notification" />
            </nz:backend.notification.createLink>
        </p>

        <f:if condition="{notificationDefinition.processor.totalNumber} > 0">
            <f:then>
                <f:render section="ListNotifications" arguments="{notificationDefinition: notificationDefinition}" />
            </f:then>
            <f:else>
                <f:be.infobox>
                    <p>
                        <nz:t key="Backend/Module/Index/ListNotifications:no_notification_found" args="{0: notificationDefinition.label}" />
                    </p>
                </f:be.infobox>
            </f:else>
        </f:if>
    </div>
</f:section>

<f:section name="ListNotifications">
    <f:be.infobox>
        <p>
            <nz:t key="Backend/Module/Index/ListNotifications:notification_listing" args="{0: notificationDefinition.label}" />
        </p>
    </f:be.infobox>

    <div class="row">
        <div class="col-md-12">
            <table class="table table-striped table-hover">
                <thead>
                <tr>
                    <th width="32">#</th>
                    <th>
                        <nz:t key="Backend/Module/Index/ListNotifications:table.header.title" />
                    </th>
                    <th>
                        <nz:t key="Backend/Module/Index/ListNotifications:table.header.event" />
                    </th>
                    <th class="text-right">
                        <nz:t key="Backend/Module/Index/ListNotifications:table.header.action" />
                    </th>
                </tr>
                </thead>

                <f:for each="{notificationDefinition.processor.allNotifications}" as="notification">
                    <tr id="{notification.notificationIdentifier}-{notification.uid}">
                        <td>
                            <nz:backend.notification.showLink notification="{notification}"
                                                              graceful="1"
                                                              title="{nz:t(key: 'Backend/Module/Index/ListNotifications:action.show', args: {0: notification.title})}">
                                <strong>{notification.uid}</strong>
                            </nz:backend.notification.showLink>
                        </td>

                        <td>
                            <nz:backend.notification.showLink notification="{notification}"
                                                              graceful="1"
                                                              title="{nz:t(key: 'Backend/Module/Index/ListNotifications:action.show', args: {0: notification.title})}">
                                {notification.title}
                            </nz:backend.notification.showLink>
                        </td>

                        <td>
                            <f:link.action action="showEvent"
                                           title="{nz:t(key: 'Backend/Module/Index/Global:show_event_details', args: {0: notification.eventDefinition.label})}"
                                           arguments="{eventIdentifier: notification.eventDefinition.fullIdentifier}">
                                {notification.eventDefinition.label} ({notification.eventDefinition.group.label})
                            </f:link.action>
                        </td>

                        <td align="right">
                            <div class="btn-group" role="group">
                                <nz:backend.notification.editLink notification="{notification}"
                                                                  class="btn btn-default"
                                                                  title="{nz:t(key: 'Backend/Module/Index/Global:edit_notification')}">
                                    <nz:core.icon identifier="actions-open" />
                                </nz:backend.notification.editLink>

                                <nz:backend.notification.showLink notification="{notification}"
                                                                  class="btn btn-default"
                                                                  title="{nz:t(key: 'Backend/Module/Index/ListNotifications:action.show', args: {0: notification.title})}">
                                    <nz:core.icon identifier="actions-view" />
                                </nz:backend.notification.showLink>
                            </div>
                        </td>
                    </tr>
                </f:for>
            </table>
        </div>
    </div>
</f:section>
