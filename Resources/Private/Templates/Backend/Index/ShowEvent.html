{namespace nz=CuyZ\Notiz\ViewHelpers}
{namespace b = TYPO3\CMS\Backend\ViewHelpers}

<f:layout name="Backend/Default" />

<f:section name="HeaderButtons">
    <f:render partial="Backend/Index/HeaderButtons" section="Buttons" arguments="{_all}" />
</f:section>

<f:section name="Content">
    <f:render partial="Backend/Index/CreateNotificationModal"
              section="Content"
              arguments="{definition: definition, eventDefinition: eventDefinition}" />

    <div class="container">
        <div class="page-header">
            <h1>
                <nz:t key="Backend/Module/Index/ShowEvent:show_event.title" args="{0: eventDefinition.label}" />
            </h1>
        </div>

        <p>
            <f:link.action action="listEvents"
                           controller="Backend\Index"
                           class="btn btn-default">
                <core:icon identifier="actions-view-go-back" />
                <nz:t key="Backend/Module/Index/Global:show_list_view" />
            </f:link.action>

            <a href="#"
               class="btn btn-default"
               data-toggle="modal"
               data-target="#create-notification">

                <core:icon identifier="actions-add" />
                <nz:t key="Backend/Module/Index/Global:create_notification" />
            </a>
        </p>

        <f:if condition="{eventDefinition.description}">
            <blockquote>
                <nz:format.nl2brTrim>{eventDefinition.description}</nz:format.nl2brTrim>
            </blockquote>
        </f:if>

        <h2>
            <nz:t key="Backend/Module/Index/ShowEvent:notifications_bound_to_event" />
        </h2>

        <table class="table table-striped table-hover">
            <f:for each="{notifications}" as="notification">
                <tr>
                    <td width="32">
                        <core:icon identifier="{notification.definition.iconIdentifier}" />
                    </td>

                    <td>
                        <f:link.action action="listNotifications"
                                       arguments="{notificationIdentifier: notification.definition.identifier, filterEvent: eventDefinition.identifier}"
                                       title="{nz:t(key: 'Backend/Module/Index/ShowEvent:show_notifications_bound_to_event', args: '{0: notification.definition.label}')}">
                            {notification.definition.label}

                            <f:if condition="{notification.count}">
                                ({notification.count})
                            </f:if>
                        </f:link.action>
                    </td>

                    <td align="right">
                        <div class="btn-group" role="group">
                            <f:link.action action="listNotifications"
                                           arguments="{notificationIdentifier: notification.definition.identifier, filterEvent: eventDefinition.identifier}"
                                           class="btn btn-default"
                                           title="{nz:t(key: 'Backend/Module/Index/ShowEvent:show_notifications_bound_to_event', args: '{0: notification.definition.label}')}">
                                <core:icon identifier="actions-view" />
                            </f:link.action>
                        </div>
                    </td>
                </tr>
            </f:for>
        </table>
    </div>
</f:section>
